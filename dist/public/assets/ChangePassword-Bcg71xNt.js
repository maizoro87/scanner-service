import{r as n,d as C,b as N,j as e,C as P,e as b,f as v,n as S,a as L,o as E,p as F,I as l,q as O,B as q,L as A,s as T}from"./index-Cj9AK73v.js";import{L as i}from"./label-Dfr3Tkin.js";function D(){const[c,p]=n.useState(""),[a,w]=n.useState(""),[d,h]=n.useState(""),[t,m]=n.useState(!1),[u,o]=n.useState(""),[,x]=C(),{toast:g}=N(),j=async s=>{if(s.preventDefault(),o(""),a!==d){o("Passwords do not match");return}if(a.length<8){o("Password must be at least 8 characters");return}m(!0);try{const r=await fetch("/api/auth/admin/change-password",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({currentPassword:c,newPassword:a})}),y=await r.json();if(!r.ok)throw new Error(y.error||"Failed to change password");g({title:"Password changed successfully",description:"You can now use your new password to login"}),x("/admin")}catch(r){o(r instanceof Error?r.message:"Failed to change password")}finally{m(!1)}},f=[{met:a.length>=8,text:"At least 8 characters"},{met:/[A-Z]/.test(a),text:"One uppercase letter"},{met:/[a-z]/.test(a),text:"One lowercase letter"},{met:/[0-9]/.test(a),text:"One number"}];return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsxs(P,{className:"w-full max-w-md",children:[e.jsxs(b,{className:"space-y-1",children:[e.jsx(v,{className:"text-2xl font-bold text-center",children:"Change Your Password"}),e.jsx(S,{className:"text-center",children:"You must change your password before continuing"})]}),e.jsx(L,{children:e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[u&&e.jsx(E,{variant:"destructive",children:e.jsx(F,{children:u})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"current-password",children:"Current Password"}),e.jsx(l,{id:"current-password",type:"password",placeholder:"Enter your current password",value:c,onChange:s=>p(s.target.value),required:!0,disabled:t,autoComplete:"current-password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"new-password",children:"New Password"}),e.jsx(l,{id:"new-password",type:"password",placeholder:"Enter your new password",value:a,onChange:s=>w(s.target.value),required:!0,disabled:t,autoComplete:"new-password"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"confirm-password",children:"Confirm New Password"}),e.jsx(l,{id:"confirm-password",type:"password",placeholder:"Confirm your new password",value:d,onChange:s=>h(s.target.value),required:!0,disabled:t,autoComplete:"new-password"})]}),a&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Password requirements:"}),e.jsx("ul",{className:"space-y-1",children:f.map((s,r)=>e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx(O,{className:`h-4 w-4 ${s.met?"text-green-500":"text-gray-300"}`}),e.jsx("span",{className:s.met?"text-green-700":"text-gray-500",children:s.text})]},r))})]}),e.jsx(q,{type:"submit",className:"w-full",disabled:t||!c||!a||!d,children:t?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Changing password..."]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"Change Password"]})})]})})]})})}export{D as default};
