import{r as u,b as I,a3 as L,u as N,y as w,j as e,A as F,m as U,B as m,P as C,C as p,a as g,z as q,I as f,i as S,e as E,f as k,W as M,E as P,G as Q,aL as $,l as z}from"./index-Cj9AK73v.js";import{L as b}from"./label-Dfr3Tkin.js";import{D as B,a as K,b as G,c as R}from"./dialog-CYYKERfK.js";import{a as v}from"./api-DJ2ai4R4.js";import{V}from"./video-detbOD_e.js";function Y(){const[o,n]=u.useState(!1),[c,l]=u.useState(""),[i,t]=u.useState("all"),{toast:h}=I(),x=L(),{data:r=[],isLoading:a}=N({queryKey:["/api/admin/videos",c,i],queryFn:()=>v(`/api/admin/videos?search=${c}&tool=${i}`,"GET")}),{data:d=[]}=N({queryKey:["/api/tools"],queryFn:()=>v("/api/tools","GET")}),T=w({mutationFn:s=>v("/api/admin/videos","POST",s),onSuccess:()=>{x.invalidateQueries({queryKey:["/api/admin/videos"]}),n(!1),h({title:"Success",description:"Video added successfully"})}}),A=w({mutationFn:s=>v(`/api/admin/videos/${s}`,"DELETE"),onSuccess:()=>{x.invalidateQueries({queryKey:["/api/admin/videos"]}),h({title:"Success",description:"Video deleted successfully"})}}),D=s=>{const j=s.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\n?#]+)/);if(j)return{platform:"youtube",videoId:j[1],embedUrl:`https://www.youtube.com/embed/${j[1]}`,thumbnail:`https://img.youtube.com/vi/${j[1]}/maxresdefault.jpg`};const y=s.match(/vimeo\.com\/(\d+)/);return y?{platform:"vimeo",videoId:y[1],embedUrl:`https://player.vimeo.com/video/${y[1]}`,thumbnail:""}:null};return e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx(F,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(U,{title:"Video Library",breadcrumb:"Content Management / Video Library"}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Video Library"}),e.jsxs(m,{onClick:()=>n(!0),className:"bg-royal-blue text-white hover:bg-royal-blue-dark",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Add Video"]})]}),e.jsx(p,{children:e.jsx(g,{className:"pt-6",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(f,{placeholder:"Search videos...",value:c,onChange:s=>l(s.target.value),className:"pl-10"})]}),e.jsxs("select",{value:i,onChange:s=>t(s.target.value),className:"px-4 py-2 border rounded-md",children:[e.jsx("option",{value:"all",children:"All Tools"}),d==null?void 0:d.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]})})}),a?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(s=>e.jsxs(p,{className:"animate-pulse",children:[e.jsx("div",{className:"h-48 bg-gray-200"}),e.jsxs(g,{className:"pt-4",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]},s))}):(r==null?void 0:r.length)===0?e.jsx(p,{className:"text-center py-12",children:e.jsxs(g,{children:[e.jsx(V,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No videos found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Start building your video library"}),e.jsxs(m,{onClick:()=>n(!0),className:"bg-royal-blue text-white hover:bg-royal-blue-dark",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Add First Video"]})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r==null?void 0:r.map(s=>e.jsxs(p,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative h-48 bg-gray-100",children:[s.thumbnail?e.jsx("img",{src:s.thumbnail,alt:s.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(V,{className:"h-12 w-12 text-gray-400"})}),e.jsxs("div",{className:"absolute bottom-2 right-2 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-sm",children:[Math.floor(s.duration/60),":",(s.duration%60).toString().padStart(2,"0")]}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx(S,{variant:"secondary",className:"capitalize",children:s.platform})})]}),e.jsxs(E,{children:[e.jsx(k,{className:"text-lg line-clamp-2",children:s.title}),s.tool&&e.jsxs(S,{variant:"outline",className:"w-fit",children:[e.jsx(M,{className:"h-3 w-3 mr-1"}),s.tool.name]})]}),e.jsxs(g,{children:[e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-4",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(P,{className:"h-4 w-4"}),s.viewCount]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"h-4 w-4"}),new Date(s.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(m,{size:"sm",variant:"outline",className:"flex-1",asChild:!0,children:e.jsxs("a",{href:s.videoUrl,target:"_blank",rel:"noopener noreferrer",children:[e.jsx($,{className:"h-4 w-4 mr-1"}),"Play"]})}),e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>A.mutate(s.id),children:e.jsx(z,{className:"h-4 w-4"})})]})]})]},s.id))}),e.jsx(B,{open:o,onOpenChange:n,children:e.jsxs(K,{children:[e.jsx(G,{children:e.jsx(R,{children:"Add Video to Library"})}),e.jsx(H,{tools:d,onSubmit:s=>T.mutate(s),parseVideoUrl:D})]})})]})})]})]})}function H({tools:o,onSubmit:n,parseVideoUrl:c}){const[l,i]=u.useState({title:"",description:"",videoUrl:"",toolId:"",tags:[]}),[t,h]=u.useState(null),x=a=>{i({...l,videoUrl:a});const d=c(a);d&&h(d)},r=a=>{a.preventDefault(),n({...l,platform:(t==null?void 0:t.platform)||"custom",videoId:(t==null?void 0:t.videoId)||"",thumbnail:(t==null?void 0:t.thumbnail)||""})};return e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"videoUrl",children:"Video URL *"}),e.jsx(f,{id:"videoUrl",type:"url",value:l.videoUrl,onChange:a=>x(a.target.value),placeholder:"https://youtube.com/watch?v=...",required:!0}),t&&e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["âœ“ Valid ",t.platform," video detected"]})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"title",children:"Title *"}),e.jsx(f,{id:"title",value:l.title,onChange:a=>i({...l,title:a.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"description",children:"Description"}),e.jsx("textarea",{id:"description",className:"w-full min-h-[80px] p-2 border rounded",value:l.description,onChange:a=>i({...l,description:a.target.value})})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"toolId",children:"Associated Tool"}),e.jsxs("select",{id:"toolId",value:l.toolId,onChange:a=>i({...l,toolId:a.target.value}),className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",children:"No tool association"}),o==null?void 0:o.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsx(m,{type:"submit",className:"w-full bg-royal-blue text-white hover:bg-royal-blue-dark",children:"Add Video"})]})}export{Y as default};
